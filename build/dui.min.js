define("format",[],function(){var e=function(e,t){t=t||0;if(t==0)return e;e=parseFloat(e);var n=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return n.toFixed(t)},t=function(t,n){n=n||0;if(t==0||t<1e4)return e(t,n);unit=typeof unit=="undefined"?1:0;var r="";return t<1e6?(t/=1e4,r="万"):t<1e7?(t/=1e6,r="百万"):t<1e8?(t/=1e7,r="千万"):(t/=1e8,r="亿"),e(t,n)+"<i>"+r+"</i>"},n=function(t,n){n=n||0;var r=parseFloat(t);if(r==0)return e(r,n);var i=[];while(r/1e3||r%1e3){var s=r%1e3,o="";r=parseInt(r/1e3),r>0&&(s<10?o="00":s<100&&(o="0")),i.length==0&&(s=e(s,n)),o!==""&&(s=o+s),i.unshift(s)}return i.join(",")};return{money:function(e){return n(e,2)},rate:function(t){return e(t,2)+"%"},intUnit:function(e){var n=e<1e4?0:1;return t(e,n)},intComma:function(e){return n(e,0)}}}),define("data/errcode",[],function(){return{1:"cannot find container to render"}}),define("error",["./data/errcode"],function(e){function t(t){var n="unkonw error";throw typeof e[t]!="undefined"&&(n=e[t]),new Error(n)}return t}),define("dom",["jquery"],function(e){function t(){this.init.apply(this,arguments)}return t.get=function(n){var r=e(n);return r.length==0?null:new t(r)},t.prototype={init:function(t){return typeof t=="string"?this.dom=e("<"+t+"></"+t+">"):this.dom=t,this},addClass:function(e){return this.dom.addClass(e),this},removeClass:function(e){return this.dom.removeClass(e),this},css:function(e){return this.dom.css(e),this},attr:function(e,t){return this.dom.attr(e,t),this},text:function(e){return this.dom.text(e),this},html:function(e){return e instanceof t?this.dom.html(e.dom):this.dom.html(e),this},append:function(e){return e instanceof t?this.dom.append(e.dom):typeof e=="string"&&this.dom.append(e),this},prepend:function(e){return e instanceof t?this.dom.prepend(e.dom):typeof e=="string"&&this.dom.prepend(e),this},after:function(e){return this.dom.after(e.dom),this},empty:function(){return this.dom.empty(),this},bind:function(e,t){return this.dom.bind(e,t),this},children:function(e){return t.get(this.dom.children().eq(e))},hide:function(){return this.dom.hide(),this},show:function(){return this.dom.show(),this},top:function(){return this.dom.offset().top},left:function(){return this.dom.offset().left},right:function(){return this.dom.offset().right},width:function(){return this.dom.width()},height:function(){return this.dom.height()},scrollTop:function(){return this.dom.scrollTop()},clone:function(e){return e=e||!1,new t(this.dom.clone(e))}},t}),define("data/css",[],function(){return{table:{box:"x-tbl",toolbar:"x-tbl-tools",content:"x-tbl-content",footer:"x-tbl-footer",td:{align:{left:"td-align-left",center:"td-align-center",right:"td-align-right"},highlight:"td-highlight"},th:{align:{center:"th-align-center",left:"th-align-left"}},tr:{d1:{init:"tr-d1",open:"tr-d1-open",close:"tr-d1-close"},d2:"tr-d2",sum:"tr-sum"},realwidth:"x-tbl-realwidth",bigfont:{icon:"tools-icon-font",biger:"x-tbl-bigfont"},numswitch:{icon:"tools-icon-number-switch"}},pager:{box:"x-widget-pager",disabled:"disabled",current:"current",dots:"dots"},sort:{init:"order","-1":"order-down",1:"order-up"}}}),define("data/var",[],function(){return{sort:{desc:-1,asc:1},defaultVar:"-",sum:{text:"Total"},valign:{top:"top",bottom:"bottom"},pager:{prev:"Prev",next:"Next",dots:"..."},toolbar:{right:24}}}),define("ajax",["jquery"],function(e){var t=function(t,n,r,i){i=i||5e3,e.ajax({type:"GET",url:t,timeout:i,dataType:"json",success:function(e){typeof n=="function"&&n(e)},error:function(){typeof r=="function"&&r()}})},n=function(t,n,r,i,s){s=s||5e3,e.ajax({type:"POST",url:t,timeout:s,dataType:"json",data:n,success:function(e){typeof r=="function"&&r(e)},error:function(){typeof i=="function"&&i()}})};return{get:t,post:n}}),define("math",[],function(){return{add:function(e,t){var n=e%1,r=t%1;if(n===0&&r===0)return e+t;n!==0&&(n=e.toString().split(".")[1].length),r!==0&&(r=t.toString().split(".")[1].length);var i=Math.pow(10,Math.max(n,r));return(e*i+t*i)/i}}}),define("core",["./format","./error","./dom","./data/css","./data/var","./ajax","./math"],function(e,t,n,r,i,s,o){var u=function(){};return u.extend=u.prototype.extend=function(e){for(var t in e)this[t]=e[t]},u.extend({isArray:Array.isArray,inArray:function(e,t){return u.isArray(t)?t.indexOf(e)>=0?!0:!1:!1},isNumber:function(e){return!u.isArray(e)&&e-parseFloat(e)+1>=0},isString:function(e){return toString.call(e)==="[object String]"},isObject:function(e){return toString.call(e)==="[object Object]"},isNaN:function(e){return!u.isString(e)&&!u.isObject(e)&&!u.isArray(e)&&isNaN(e)},format:e,error:t,dom:n,css:r,"var":i,ajax:s,math:o}),u}),define("widget/table/toolbar/numSwitch",["../../../core"],function(e){var t=function(){this.init.apply(this,arguments)};return t.prototype={init:function(e,t){var n=this;n.table=e,n.isSwitch=!1,n.switchStat="format";for(var r in t)if(t[r].numSwitch||!1){n.isSwitch=!0;break}},render:function(t){var n=this,r=new e.dom("span");r.addClass(e.css.table.numswitch.icon),r.bind("click",function(){n.switchStat=n.switchStat=="num"?"format":"num",n.table.content.body.numSwitch(n.switchStat)}),t.append(r)}},t}),define("widget/table/toolbar/bigfont",["../../../core"],function(e){var t=function(){this.init.apply(this,arguments)};return t.prototype={init:function(e,t){var n=this;n.table=e,n.isBig=!1},render:function(t){var n=this,r=new e.dom("span");r.addClass(e.css.table.bigfont.icon),r.bind("click",function(){n.isBig=n.isBig?!1:!0,n.isBig?n.table.box.addClass(e.css.table.bigfont.biger):n.table.box.removeClass(e.css.table.bigfont.biger)}),t.append(r)}},t}),define("widget/table/toolbar/toolbar",["../../../core","./numSwitch","./bigfont"],function(e,t,n){var r=function(){this.init.apply(this,arguments)};return r.prototype={init:function(r,i){var s=this;s.table=r,s.box=new e.dom("div"),s.box.addClass(e.css.table.toolbar).hide(),s.show=!1,s.closeT=null,s.bigfont=new n(r),s.numSwitch=new t(r,i.field)},render:function(e){var t=this;t.bigfont.render(t.box),t.numSwitch.render(t.box),t.box.bind("mouseenter",function(){t.show=!0}),t.box.bind("mouseleave",function(){t.closeBar(),t.show=!1}),t.table.box.bind("mouseenter",function(){t.showBar(),t.show=!0}),t.table.box.bind("mouseleave",function(){t.closeBar(),t.show=!1}),e.append(t.box)},showBar:function(){var t=this,n=t.table.box.top()-t.box.height(),r=t.table.box.left()+t.table.box.width()-t.box.width()-e.var.toolbar.right;t.box.css({top:n,left:r}).show()},closeBar:function(){var e=this;clearTimeout(e.closeT),e.closeT=setTimeout(function(){e.show||e.box.hide()},300)}},r}),define("widget/table/head/head",["../../../core"],function(e){function t(){this.init.apply(this,arguments)}return t.prototype={init:function(t,n){var r=this;r.table=t,r.field=[],r.fieldGroupMap=[],r.fieldGroupCnt=[],r.sortField=-1,r.fixed=n.head.fixed||!1;var i=n.field,s=0;for(var o in i){var u=-1;if(typeof i[o].fieldGroup!="undefined"){var a=Math.max(r.fieldGroupMap.length-1,0);s>0&&r.field[s-1].groupId==a&&r.fieldGroupMap[a]==i[o].fieldGroup?(r.fieldGroupCnt[a]++,u=a):(r.fieldGroupMap.push(i[o].fieldGroup),r.fieldGroupCnt.push(1),u=r.fieldGroupMap.length-1)}r.field.push({idx:s,text:i[o].text||"",sortable:i[o].sortable||!1,ord:e.var.sort.asc,width:i[o].width||100,groupId:u,fieldClass:i[o].fieldClass||!1}),s++}r.isFieldGroup=r.fieldGroupMap.length>0},render:function(t){var n=this,r=new e.dom("colgroup"),i=new e.dom("thead"),s=new e.dom("tr"),o=new e.dom("tr"),u=[];for(var a in n.field){var f=new e.dom("col");f.attr("width",n.field[a].width),r.append(f);var l=new e.dom("th");l.html(n.field[a].text);if(n.isFieldGroup)if(n.field[a].groupId>=0){o.append(l);var c=n.field[a].groupId;if(!e.inArray(c,u)){u.push(c);var h=new e.dom("th");h.attr("colspan",n.fieldGroupCnt[c]).addClass(e.css.table.th.align.center).html(n.fieldGroupMap[c]),s.append(h)}}else l.attr("rowspan",2),s.append(l);else o.append(l);n.field[a].fieldClass&&l.addClass(n.field[a].fieldClass),n.field[a].dom=l,n.bindThEvent(a)}n.isFieldGroup&&i.append(s),i.append(o),t.append(r),t.append(i),n.thead=i,n.colgroup=r,n.bindFixedEvent()},bindFixedEvent:function(){var t=this;if(!t.fixed)return;var n=e.dom.get("body"),r=e.dom.get(document),i=new e.dom("div");i.hide(),i.css({position:"absolute"}),i.append(t.colgroup.clone(!0)),i.append(t.thead.clone(!0)),n.append(i),r.bind("scroll",function(){var e=t.table.box.top(),n=t.table.box.top()+t.table.box.height()-t.thead.height(),s=t.table.box.left(),o=r.scrollTop();o>e&&o<n?i.show().css({top:o,left:s}):i.hide(),o>=n&&i.hide()})},bindThEvent:function(t){var n=this,r=n.field[t];r.sortable&&(r.dom.addClass(e.css.sort.init),r.dom.bind("click",function(){if(n.sortField>0&&t!==n.sortField){var i=n.field[n.sortField];i.dom.removeClass(e.css.sort[i.ord]),i.ord=e.var.sort.asc,n.table.body.lightOff(i.idx)}var s=e.css.sort[r.ord];r.ord=r.ord==e.var.sort.asc?e.var.sort.desc:e.var.sort.asc;var o=e.css.sort[r.ord];r.dom.removeClass(s).addClass(o),n.table.body.sort(t,r.ord),n.sortField=t,n.table.body.light(t)}))}},t}),define("widget/table/body/func",["../../../core"],function(e){return{sortTr:function(e,t,n){e.sort(function(e,r){return e.row[t].num==r.row[t].num?0:e.row[t].num>r.row[t].num?n:-n})},createTr:function(t){var n=new e.dom("tr");for(var r in t){var i=new e.dom("td");t[r].dataClass&&i.addClass(t[r].dataClass),t[r].align?typeof e.css.table.td.align[t[r].align]!="undefined"&&i.addClass(e.css.table.td.align[t[r].align]):e.isNumber(t[r].num)&&i.addClass(e.css.table.td.align.right),i.html(t[r].format),n.append(i)}return n},formatRow:function(t,n){var r=[];for(var i in n){var s=e.var.defaultVar;typeof n[i].formula=="function"?s=n[i].formula(t):typeof t[n[i].dataIndex]!="undefined"&&(s=t[n[i].dataIndex]),e.isNaN(s)&&(s=e.var.defaultVar);var o=s;s!==e.var.defaultVar&&typeof n[i].format=="function"&&(o=n[i].format(s)),s===e.var.defaultVar&&(s=0),r.push({format:o,num:s,dataClass:n[i].dataClass,align:n[i].align})}return r},formatSum:function(t,n){var r=[];for(var i in n){var s=e.var.defaultVar;if(n[i].isSum){typeof n[i].formula=="function"?s=n[i].formula(t):typeof t[n[i].dataIndex]!="undefined"&&(s=t[n[i].dataIndex]),e.isNaN(s)&&(s=e.var.defaultVar);var o=s;s!==e.var.defaultVar&&typeof n[i].format=="function"&&(o=n[i].format(s))}else var o=s;r.push({format:o,num:s,dataClass:n[i].dataClass,align:n[i].align})}return r}}}),define("widget/table/body/lineal",["../../../core","./func"],function(e,t){function n(){this.init.apply(this,arguments)}return n.prototype={init:function(n){var r=this;r.field=n.field,r.sum=n.sum,r.data=[],r.sumData={row:{}},r.sumData.row[n.field[0].dataIndex]=n.sum.text;var i={};for(var s in n.data){r.data.push({row:t.formatRow(n.data[s],r.field)});for(var o in n.data[s])r.sum.is&&e.isNumber(n.data[s][o])&&(i[o]=i[o]||0,i[o]=e.math.add(i[o],n.data[s][o]))}for(var s in r.data){var u=t.createTr(r.data[s].row);r.data[s].dom=u}r.sum.is&&(i[r.field[r.sum.fieldIndex].dataIndex]=n.sum.text,r.sumData.row=t.formatSum(i,r.field),r.sumData.dom=t.createTr(r.sumData.row).addClass(e.css.table.tr.sum))},render:function(e){var t=this;for(var n in t.data)e.append(t.data[n].dom);t.renderSum(e)},renderSum:function(t){var n=this;if(!n.sum.is)return;n.sum.valign===e.var.valign.top?t.prepend(n.sumData.dom):t.append(n.sumData.dom)},sort:function(e,n){t.sortTr(this.data,e,n)},light:function(t){var n=this;for(var r in n.data)n.data[r].dom.children(t).addClass(e.css.table.td.highlight)},lightOff:function(t){var n=this;for(var r in n.data)n.data[r].dom.children(t).removeClass(e.css.table.td.highlight)},numSwitch:function(t){var n=this;for(var r in n.field){if(!n.field[r].numSwitch)continue;for(var i in n.data){if(n.data[i].row[r].format==e.var.defaultVar)continue;n.data[i].dom.children(r).text(n.data[i].row[r][t])}n.sum.is&&n.sumData.row[r].format!==e.var.defaultVar&&n.sumData.dom.children(r).text(n.sumData.row[r][t])}}},n}),define("widget/table/body/grouped",["../../../core","./func"],function(e,t){function n(){this.init.apply(this,arguments)}return n.prototype={init:function(n){var r=this;r.field=n.field,r.group=n.group,r.sum=n.sum,r.data=[],r.sumData={};var i=[],s={};for(var o in n.data){var u=n.data[o][r.group.dataIndex],a=i.indexOf(u);a<0&&(i.push(u),a=i.length-1,r.data[a]={row:{},sub:[],open:!1},r.data[a].row[r.group.fieldIndex]=u);var f=t.formatRow(n.data[o],r.field);r.data[a].sub.push({row:f,dom:t.createTr(f).addClass(e.css.table.tr.d2)});for(var l in n.data[o]){if(!e.isNumber(n.data[o][l]))continue;l!==r.group.fieldIndex&&(r.data[a].row[l]=r.data[a].row[l]||0,r.data[a].row[l]=e.math.add(r.data[a].row[l],n.data[o][l])),r.sum.is&&e.isNumber(n.data[o][l])&&(s[l]=s[l]||0,s[l]=e.math.add(s[l],n.data[o][l]))}}for(var o in r.data)r.data[o].row=t.formatRow(r.data[o].row,r.field),r.data[o].dom=t.createTr(r.data[o].row).addClass(e.css.table.tr.d1.init),r.bindOpenEvent(r.data[o]);r.sum.is&&(s[r.field[r.sum.fieldIndex].dataIndex]=n.sum.text,r.sumData.row=t.formatSum(s,r.field),r.sumData.dom=t.createTr(r.sumData.row).addClass(e.css.table.tr.sum))},render:function(e){var t=this;for(var n in t.data){e.append(t.data[n].dom);for(var r in t.data[n].sub)t.data[n].open?t.data[n].sub[r].dom.show():t.data[n].sub[r].dom.hide(),e.append(t.data[n].sub[r].dom)}t.renderSum(e)},renderSum:function(t){var n=this;if(!n.sum.is)return;n.sum.valign===e.var.valign.top?t.prepend(n.sumData.dom):t.append(n.sumData.dom)},sort:function(e,n){var r=this;t.sortTr(r.data,e,n);for(var i in r.data)t.sortTr(r.data[i].sub,e,n)},light:function(t){var n=this;for(var r in n.data){n.data[r].dom.children(t).addClass(e.css.table.td.highlight);for(var i in n.data[r].sub)n.data[r].sub[i].dom.children(t).addClass(e.css.table.td.highlight)}},lightOff:function(t){var n=this;for(var r in n.data){n.data[r].dom.children(t).removeClass(e.css.table.td.highlight);for(var i in n.data[r].sub)n.data[r].sub[i].dom.children(t).removeClass(e.css.table.td.highlight)}},numSwitch:function(t){var n=this;for(var r in n.field){if(!n.field[r].numSwitch)continue;for(var i in n.data){if(n.data[i].row[r].format==e.var.defaultVar)continue;n.data[i].dom.children(r).text(n.data[i].row[r][t]);for(var s in n.data[i].sub){if(n.data[i].sub[s].row[r].format==e.var.defaultVar)continue;n.data[i].sub[s].dom.children(r).text(n.data[i].sub[s].row[r][t])}}n.sum.is&&n.sumData.row[r].format!==e.var.defaultVar&&n.sumData.dom.children(r).text(n.sumData.row[r][t])}},bindOpenEvent:function(t){var n=this;t.dom.bind("click",function(n){t.open?(t.open=!1,t.dom.removeClass(e.css.table.tr.d1.open).addClass(e.css.table.tr.d1.close)):(t.open=!0,t.dom.removeClass(e.css.table.tr.d1.close).addClass(e.css.table.tr.d1.open));for(var r in t.sub)t.open?t.sub[r].dom.show():t.sub[r].dom.hide()})}},n}),define("widget/table/body/body",["../../../core","./lineal","./grouped"],function(e,t,n){function r(){this.init.apply(this,arguments)}return r.prototype={init:function(r,i){var s=this;s.table=r,s.tbody=new e.dom("tbody"),s.impl=null;var o={text:e.var.sum.text,valign:e.var.valign.bottom,fieldIndex:0,is:!1},u={fieldIndex:null,dataIndex:null},a=[];e.isObject(i.sum)&&(o.text=i.sum.text||o.text,o.valign=i.sum.valign||o.valign,o.fieldIndex=i.sum.fieldIndex||o.fieldIndex);for(var f in i.field){var l={numSwitch:i.field[f].numSwitch||!1,format:i.field[f].format||!1,formula:i.field[f].formula||!1,dataIndex:i.field[f].dataIndex,isSum:i.field[f].isSum||!1,dataClass:i.field[f].dataClass||!1,align:i.field[f].align||"right"};a.push(l),l.isSum&&(o.is=!0)}o.is&&(a[o.fieldIndex].isSum=!0);var c=!1;if(e.isObject(i.dataGroup)){var h=i.dataGroup.fieldIndex||0;e.isNumber(h)&&e.isString(i.dataGroup.dataIndex)&&e.isObject(i.field[h])&&i.dataGroup.dataIndex&&(c=!0,u.fieldIndex=i.field[h].dataIndex,u.dataIndex=i.dataGroup.dataIndex)}var p={field:a,sum:o,data:i.data};c?(p.group=u,s.impl=new n(p)):s.impl=new t(p)},render:function(e){var t=this;t.tbody.empty(),t.impl.render(t.tbody),e.append(t.tbody)},sort:function(e,t){var n=this;n.impl.sort(e,t),n.impl.render(n.tbody)},numSwitch:function(e){this.impl.numSwitch(e)},light:function(e){this.impl.light(e)},lightOff:function(e){this.impl.lightOff(e)}},r}),define("widget/table/table",["../../core","./toolbar/toolbar","./head/head","./body/body"],function(e,t,n,r){function i(){this.init.apply(this,arguments)}return i.prototype={init:function(i,s){var o=this;o.outer=e.dom.get(i),o.outer===null&&e.error(1),o.realwidth=s.realwidth||!1,o.createBox(),o.toolbar=new t(o,s),o.head=new n(o,s),o.body=new r(o,s),o.render()},render:function(){var t=this;t.toolbar.render(e.dom.get("body")),t.head.render(t.box),t.body.render(t.box),t.outer.append(t.box)},createBox:function(){var t=this,n=new e.dom("div");n.addClass(e.css.table.box),t.realwidth&&n.addClass(e.css.table.realwidth),t.box=new e.dom("table"),n.append(t.box)}},e.extend({table:i}),e}),define("widget/pager/pager",["../../core"],function(e){function t(){this.init.apply(this,arguments)}return t.prototype={init:function(t,n){var r=this;r.pageNum=n.pageNum||1;if(r.pageNum<=1)return;var i=e.dom.get(t);i===null&&e.error(1);var s=new e.dom("div");s.addClass(e.css.pager.box),i.append(s),r.pageList=new e.dom("div"),s.append(r.pageList),r.rendered=!1,r.showNum=n.showNum||5,r.edgeNum=n.edgeNum||1,r.onSelect=n.onSelect||!1,r.last=r.pageNum-1,r.current=n.current||0,r.current>r.last&&(r.current=0);var o=(r.showNum-1)/2;r.showNum%2==1?r.left=r.right=o:(r.left=Math.floor(o),r.right=Math.ceil(o)),r.prev=r.createBtn(n.prevText||e.var.pager.prev,"prev"),s.prepend(r.prev),r.next=r.createBtn(n.nextText||e.var.pager.next,"next"),s.append(r.next),r.render()},createBtn:function(t,n){var r=this,i=new e.dom("a");return i.text(t),n!=="undefined"&&n!==!1&&i.bind("click",function(){r.selectPage(n)}),i},render:function(){var t=this;if(t.pageNum<=t.showNum+t.edgeNum&&t.rendered)return;t.pageList.empty();var n=Math.max(0,t.current-t.left),r=Math.min(n+t.showNum-1,t.last);r==t.last&&(n=r-t.showNum+1);var i=Math.min(t.edgeNum,n);for(var s=0;s<i;s++)t.pageList.append(t.createBtn(s+1,s));n>t.edgeNum&&t.pageList.append(t.createBtn(e.var.pager.dots).addClass(e.css.pager.dots));for(var s=n;s<=r;s++){if(s==t.current){var o=t.createBtn(s+1,!1);o.addClass(e.css.pager.current)}else var o=t.createBtn(s+1,s);t.pageList.append(o)}r<t.last-t.edgeNum&&t.pageList.append(t.createBtn(e.var.pager.dots).addClass(e.css.pager.dots));var i=Math.min(t.edgeNum,t.last-r);for(var s=i-1;s>=0;s--)t.pageList.append(t.createBtn(t.last-s+1,t.last-s));t.current==0?t.prev.addClass(e.css.pager.disabled):t.prev.removeClass(e.css.pager.disabled),t.current==t.last?t.next.addClass(e.css.pager.disabled):t.next.removeClass(e.css.pager.disabled),t.rendered=!0},selectPage:function(e){var t=this;switch(e){case"prev":if(!(t.current>0))return;t.current-=1;break;case"next":if(!(t.current<t.last))return;t.current+=1;break;default:t.current=parseInt(e)}t.render(),typeof t.onSelect=="function"&&t.onSelect(t.current)}},e.extend({pager:t}),e}),define("dui",["./core","./widget/table/table","./widget/pager/pager"],function(e){return e});